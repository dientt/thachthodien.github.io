<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>TimelineJs integration example &#8211; Micronaut Modified So Simple Theme</title>
<meta name="description" content="The following page demonstrates how to integrate Knight Lab’s TimelineJs on your blog. The original data is stored as xml file on this repository, and they are automatically loaded and parsed via javascript. :simple_smile:
">
<meta name="keywords" content="timeline, examples, music">
<meta name="author" content="Author2" />
<!-- Twitter Cards -->
<meta name="twitter:title" content="TimelineJs integration example"/>
<meta name="twitter:description" content="The following page demonstrates how to integrate Knight Lab’s TimelineJs on your blog. The original data is stored as xml file on this repository, and they are automatically loaded and parsed via javascript. :simple_smile:"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:image" content="http://localhost:4001/images/site-logo.svg"/>
<!-- Open Graph -->
<meta property="og:locale" content="en_US"/>
<meta property="og:type" content="article"/>
<meta property="og:title" content="TimelineJs integration example"/>
<meta property="og:description" content="The following page demonstrates how to integrate Knight Lab’s TimelineJs on your blog. The original data is stored as xml file on this repository, and they are automatically loaded and parsed via javascript. :simple_smile:"/>
<meta property="og:url" content="http://localhost:4001/music/timelinejs-example/"/>
<meta property="og:site_name" content="Micronaut Modified So Simple Theme"/>
<meta property="og:image" content="http://localhost:4001/images/site-logo.svg" />
<meta property="og:image:url" content="http://localhost:4001/images/site-logo.svg" />
<meta property="article:author" content="Author2">
<meta property="article:published_time" content="2017-01-24T21:15:00+01:00"/>
<meta property="article:section" content="music"/>
<meta property="article:tag" content="timeline examples music"/>
<link rel="canonical" href="http://localhost:4001/music/timelinejs-example/">
<link href="http://localhost:4001/feed.xml" type="application/atom+xml" rel="alternate" title="Micronaut Modified So Simple Theme All Posts Feed">
<link href="http://localhost:4001/feed.blog.xml" type="application/atom+xml" rel="alternate" title="Micronaut Modified So Simple Theme Blog Feed">
<link href="http://localhost:4001/feed.music.xml" type="application/atom+xml" rel="alternate" title="Micronaut Modified So Simple Theme Music Feed">
<link href="http://localhost:4001/feed.stories.xml" type="application/atom+xml" rel="alternate" title="Micronaut Modified So Simple Theme Stories Feed">
<!-- https://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<!-- Webfonts -->
<link href='https://fonts.googleapis.com/css?family=Philosopher:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700" rel="stylesheet">
<meta http-equiv="cleartype" content="on">
<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>
<!-- Navigation bar -->
<script src="/assets/js/vendor/classie.js"></script>
<script src="/assets/js/vendor/gnmenu.js"></script>
<!-- Knightlab  Timeline 3-->
<link title="timeline-styles" rel="stylesheet" href="https://cdn.knightlab.com/libs/timeline3/latest/css/timeline.css">
<script src="https://cdn.knightlab.com/libs/timeline3/latest/js/timeline.js"></script>
<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4001/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4001/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4001/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4001/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4001/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4001/images/apple-touch-icon-144x144-precomposed.png">
</head>
<body id="post">
<ul id="gn-menu" class="gn-menu-main no-print">
    <li class="gn-trigger">
        <div id="nav-icon" class="gn-icon">
          <span></span>
          <span></span>
          <span></span>
          <span></span>
        </div>
        <nav role="navigation" class="gn-menu-wrapper">
            <div class="gn-scroller">
                <ul class="gn-menu">
                <!-- submenu example -->
                <!--<li>
                        <a class="gn-icon fa-" href="" ></a>
                        <ul class="gn-submenu">
                            <li><a class="gn-icon gn-icon-illustrator">Illustrations</a></li>
                            <li><a class="gn-icon gn-icon-photoshop">Photoshop files</a></li>
                        </ul>
                    </li>-->
                    <li><a class="gn-icon fa-info" href="/about/" >About</a></li>
                    <li><a class="gn-icon fa-pencil" href="/blog/" >Blog</a></li>
                    <li><a class="gn-icon fa-music" href="/music/" >Music</a></li>
                    <li><a class="gn-icon fa-book" href="/stories/" >Stories</a></li>
                    <li><a class="gn-icon fa-tags" href="/tags/" >Tags</a></li>
                    <li><a class="gn-icon fa-link" href="/links/" >Links</a></li>
                    <li><a class="gn-icon fa-search" href="/search/" >Search</a></li>
                  <li><a class="gn-icon fa-rss" href="/feed.xml" title="Atom/RSS feed">Feed</a></li>
                </ul>
            </div>
        </nav>
    </li>
    <li><a href="/music">music</a></li>
    <li><a class="codrops-icon fa-rss" href="/feed.music.xml" target="_blank" title="music rss feed" rel="rss"><span>Subscribe</span></a></li>
    <li><a class="codrops-icon fa-long-arrow-left" href="/music/music-post-example/" title="Example of a post in music category" rel="prev"><span>Previous</span></a></li>
    <li><a class="codrops-icon gn-icon-next" href="/markup/markup-image-alignment/" title="Markup: Image Alignment" rel="next"><span>Next</span></a></li>
    <li><a class="codrops-icon fa-home" href="/"><span>Home</span></a></li>
</ul>
<!-- /.masthead-->
<div id="main" role="main">
  <article class="hentry">
    <div class="entry-wrapper">
      <header class="entry-header">
        <ul class="entry-tags">
         <i class="fa fa-tags"></i>&nbsp;<li><a href="http://localhost:4001/tags/#timeline" title="Pages tagged as timeline">timeline</a></li><li><a href="http://localhost:4001/tags/#examples" title="Pages tagged as examples">examples</a></li><li><a href="http://localhost:4001/tags/#music" title="Pages tagged as music">music</a></li>
        </ul>
          <h1 class="entry-title">TimelineJs integration example
</h1>
      </header>
      <footer class="entry-meta">
        <span class="no-print" style="float: right; padding-right: 0px; margin-right: 0px;">
	<span><a class="social-share" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4001/music/timelinejs-example/" title="Share on Facebook" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;"><i class="fa fa-facebook" aria-hidden="true"></i></a></span>
	<span style="padding-left: 5px;"><a class="social-share" href="https://twitter.com/intent/tweet?hashtags=timeline,examples,music&amp;text=TimelineJs%20integration%20example&amp;url=http://localhost:4001/music/timelinejs-example/&amp;via=" title="Share on Twitter" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;"><i class="fa fa-twitter" aria-hidden="true"></i></a></span>	
	<span style="padding-left: 5px;"><a class="social-share" href="https://plus.google.com/share?url=http://localhost:4001/music/timelinejs-example/" title="Share on Google+" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;"><i class="fa fa-google-plus" aria-hidden="true"></i></a></span>
</span>
        <span class="author vcard">By <span class="fn">Author2</span></span>
        <span class="entry-date date published" title="Published on Tue, 24 Jan 2017 21:15:00 +0100"><time datetime="2017-01-24T21:15:00+01:00"><i class="fa fa-calendar-o"></i>&nbsp;&nbsp;January 24, 2017</time></span>
        <span class="entry-readingtime" title="193 words"><i class="fa fa-clock-o"></i>&nbsp;&nbsp;1 min. reading </span>
      </footer>
      <div class="entry-content">
        <p>The following page demonstrates how to integrate <a href="https://timeline.knightlab.com" target="_blank">Knight Lab’s TimelineJs</a> on your blog. The original data is stored as xml file on this repository, and they are automatically loaded and parsed via javascript. :simple_smile:</p>
<p class="notice"><strong>Note:</strong> You may check the source xml data <a href="/docs/xmldata/example-data.xml" target="_blank"><i class="fa fa-link"></i>here</a>.</p>
<p>Showing a TimelineJs on your page can be done in merely 3 simple steps:</p>
<p>1 Create an xml file containing the data you wish to display. Make sure you use the same template as here, so that the data to be parsed properly by javascript.</p>
<p>2 Add the following YAML front matter statement on the page:</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">xmldata</span><span class="pi">:</span> 
  <span class="na">data</span><span class="pi">:</span> <span class="s">/docs/xmldata/example-data.xml</span>
  <span class="na">template</span><span class="pi">:</span> <span class="s">timelinejs</span>
</code></pre></div></div>
<p>where</p>
<ul>
  <li>data: is a relative path to the xml data you created in step-1.</li>
  <li>template: should be <code class="highlighter-rouge">timelinejs</code>.</li>
</ul>
<p>3 In markdown add the following line:</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">'timeline-js'</span> <span class="na">style=</span><span class="s">"width: 100%; height: 700px"</span><span class="nt">&gt;&lt;/div&gt;</span>
</code></pre></div></div>
<p>you may choose width and height according to your needs.</p>
<p>The final result should look like as follows:</p>
<div id="timeline-js" style="width: 100%; height: 700px"></div>
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
  </article>
  <p id="back-top" class="right"><a href="#post"><i class="fa fa-angle-double-up no-print"></i></a></p>
</div><!-- /#main -->
<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
<span>&copy; 2013-2019 Site Name.<br/>Last update on Mon, 15 Apr 2019 11:47:04 +0200</span>
<div class="social-icons">
  <a class="social-share" href="http://localhost:4001/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss fa-2x"></i></a>
</div><!-- /.social-icons -->
<span>Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; the <a href="https://github.com/TheMicronaut/micronaut-theme" rel="nofollow">Modified So Simple Theme</a>.<br/>Except where otherwise noted, content on this site is licensed under a<br/><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons International License.</a><br/><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="/images/licensebuttons-by-nc-sa.svg" /></a></span>
  </footer>
</div><!-- /.footer-wrapper -->
<script type="text/javascript">
    var BASE_URL = 'http://localhost:4001';
    var isMobile = {
        Android: function() {
            return navigator.userAgent.match(/Android/i);
        },
        BlackBerry: function() {
            return navigator.userAgent.match(/BlackBerry/i);
        },
        iOS: function() {
            return navigator.userAgent.match(/iPhone|iPad|iPod/i);
        },
        Opera: function() {
            return navigator.userAgent.match(/Opera Mini/i);
        },
        Windows: function() {
            return navigator.userAgent.match(/IEMobile/i);
        },
        any: function() {
            return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());
        }
    };  
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4001/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>
<!-- Scroll effect for invisible & lazy elements -->
<script type="text/javascript">
/* Check the location of each 'invisible' element and make visible if needed*/
function ShowInvisibleElements() {
        $('.invisible').each( function(i) {
			var middle_of_object = $(this).offset().top + ($(this).outerHeight()  * 0.35);
            var bottom_of_window = $(window).scrollTop() + $(window).height();
            /* If the object is half visible in the window... */
            if( bottom_of_window > middle_of_object ) { 
				var thisIsIframe = $(this).is("iframe");
				var thisIsImg = $(this).is("img");
				if (thisIsIframe || thisIsImg) {
					/* 1.a  object is a lazy source, load it*/
					if ($(this).data('src')) {
						$(this).prop('src', $(this).data('src')).data('src', false);
					}				
				} else {
					/* 1.b object contains lazy sources, find them and load them*/
					var $iframe=$(this).find('iframe');
					if ($iframe.data('src')) { // only do it once per iframe
						$iframe.prop('src', $iframe.data('src')).data('src', false);
					}
					var $img=$(this).find('img').each(function (index, element) { // do it for each nested image
						if ($(this).data('src')) { // only do it once per image
							$(this).prop('src', $(this).data('src')).data('src', false);
						}
					});
				}
				/* 2. fade-in the object  and remove the invisible class*/
                $(this).animate({'opacity':'1'}, 500);
				/* 3. remove the invisible class*/
				$(this).removeClass("invisible");
            } else {
			    /*invisible object not completely visible; thus, ignore the remaining invisible items.*/
                return;
            }
        });
}
$(document).ready(function() {
	/* Hide the 'back-top' element */
	$("#back-top").hide();
	ShowInvisibleElements();
   /* Every time the window is scrolled ... */
    $(window).scroll( function() {
        ShowInvisibleElements();
		/* Show or hide the back-top element */
		if ($(this).scrollTop() > 500) {
			$('#back-top').fadeIn(0);
		} else {
			$('#back-top').fadeOut(0);
		}		
    });
	/* Scroll to top */
	$(function () {
		/* scroll body to 0px on click */
		$('#back-top a').click(function () {
			$('body,html').animate({
				scrollTop: 0
			}, 400);
			return false;
		});
	});	
});
</script>
<!-- Toggle Comments -->
<script type="text/javascript">
$( "#comments" ).click(function() {
  $( "#comments-wrap" ).slideToggle( "slow", function() {
    // Animation complete.
  });
});
</script>
<!-- Replace missing images -->
<script type="text/javascript">
    $('img').error(function(){
    $(this).attr('src', '/images/Image_Not_Found.png');
	var alttext = $(this).attr('alt');
    $(this).attr('title', 'Image ['+alttext+'] Not Found.');
});
</script>
<!-- menu button -->
<script type="text/javascript">
    new gnMenu( document.getElementById( 'gn-menu' ) );
</script>
<!-- xml data load -->
<script id="timelinetemplate" type="x-jquery-tmpl">
 	<div class="invisible timeline-item">
		<div class="timeline-icon">
			<img src="/images/timeline/micronaut-white-transparent.png" alt="">
		</div>
		<div class="timeline-content ${alignment}">
			<h2>${title}</h2>
			{{if subtitle}}<h3><i class="fa fa-calendar-o"></i>&nbsp;&nbsp;${subtitle}</h3>{{/if}}
			{{if tags}}<p id="tags">${tags}</p>{{/if}}
			{{if header}}<img class="center" src="${header}" alt="image">{{/if}}
			<p>${body}<br/>{{if source}}source: <a href="${sourcelink}" target="_blank">${source}</a>{{/if}}</p>
			{{if footer}}
			{{if iframetype == "other"}}<iframe width="100%" height="250" frameborder="0" src="about:blank" data-src="${footer}"></iframe>{{/if}}
			{{if iframetype == "bandcamp"}}<iframe style="border: 0; width: 100%; height: 42px;" src="about:blank" data-src="${footer}" seamless></iframe>{{/if}}
			{{if iframetype == "soundcloud"}}<iframe width="100%" height="166" frameborder="0" src="about:blank" data-src="${footer}"></iframe>{{/if}}
			{{/if}}
		</div>
	</div>
</script>
<script type="text/javascript" language="javascript">
    $(document).ready(function() {
        var currentTemplate = "timelinejs";
        var isEmbeddedTimeline = ( currentTemplate == "timelinejs");
        $.ajax({
            type: "GET",
            url: "/docs/xmldata/example-data.xml",
            dataType: "xml",
            success: function(xml) {
                var nrOfItems = 0;
                if  (isEmbeddedTimeline) {
                  nrOfItems = RenderEmbeddedTimeline(xml);
                } else {
                    nrOfItems = RenderNativeTimeline(xml);
                }
               $("#amountxmldata").text(nrOfItems);
            },
            error: function() {
                alert("An error occurred while processing XML data.");
            }
        });
    });
function RenderNativeTimeline(xml) {
    var counter = 0;
    $(xml).find('item').each(function() {
        var dataitem =xml2jsobj(this);
        dataitem['alignment'] = (counter % 2 === 0) ? 'right' : '';
        dataitem['iframetype'] = GetFrameType(dataitem.footer);
       $( "#timelinejs" ).tmpl(dataitem).appendTo( "#timeline" );
       counter++;
    });
    return counter;
}
function RenderEmbeddedTimeline(xml) {
    var counter = 0;
    var jsonItems = {};
    jsonItems.events = [];
    $(xml).find('item').each(function() {
        var dataitem =xml2jsobj(this);
        var event =  jsObj2TimelineEvent(dataitem);
        jsonItems.events.push(event);
        counter++;
    });
    //console.log(JSON.stringify(jsonItems));
      var additionalOptions = {
        start_at_end: true,
        dragging: true,
        scale_factor: 10,
        initial_zoom: 2,
        duration: 600,
        //slide_padding_lr: 90,
        hash_bookmark: true,
        ga_property_id: ''
      }	
    timeline = new TL.Timeline('timeline-js', jsonItems, additionalOptions);
    return counter;
}
// Conversion is based on a default template; Ideally there should be a way
// to parse a custom template and generate the Timeline event from there.
function jsObj2TimelineEvent(dataitem) {
        var event = {};
        event.media = {};
        event.start_date = {};
        event.text = {};
        event.background ={};
        // 1. event background
        event.background.url = (dataitem.header == null) ?  "" : dataitem.header;
        // 2. event media
        var mediaUrl = dataitem.footer; // backwards compatible
        if (mediaUrl == null) {
            mediaUrl = (dataitem.mediaurl == null) ? "" : dataitem.mediaurl;
        }
        if (GetFrameType(mediaUrl) == "bandcamp") {
           if (isMobile.any()) {
                mediaUrl = '<iframe style="border: 0; width: 100%; height: 120px;" src="'+ mediaUrl +'/size=large/bgcol=333333/linkcol=ffffff/tracklist=false/transparent=false/artwork=small/" seamless></iframe>';
           } else {
                mediaUrl = '<iframe style="border: 0; width: 100%; height: 100%" src="'+ mediaUrl +'/size=large/bgcol=333333/linkcol=ffffff/tracklist=false/transparent=false/" seamless></iframe>';
           }
        }
        event.media.url = mediaUrl; 
        event.media.caption = (dataitem.mediacaption == null) ? "" : dataitem.mediacaption;        
        event.media.credit = (dataitem.mediacredit == null) ? "" : "Credit: " + dataitem.mediacredit;
        //event.media.thumbnail = event.background.url;
        // 3. event date
        var date = new Date(dataitem.subtitle);
        event.start_date.year = date.getFullYear();
        event.start_date.month = date.getMonth()+1;
        event.start_date.day = date.getDate();
        // 4. event text
        event.text.headline = (dataitem.title == null) ? "" : dataitem.title;
        var eventText =  (dataitem.body == null) ? " " : dataitem.body;
        var eventTextSource = "";
        if (dataitem.source != null) {
            eventTextSource = '<p class="pull-right inline-quote">source: <a href="'+dataitem.sourcelink+'" target="_blank">'+ dataitem.source +'</a></p>'
        }
        var eventTextTags = "";
        if (dataitem.tags != null) {
            var tagsString = dataitem.tags;
            var tagSeparators = [' ', ',', '·', '\\*'];
            var tags = tagsString.split(new RegExp(tagSeparators.join('|'), 'g'));
            tags = tags.filter(function(e){return e}); // clean empty values
            var parsedTags = '';
            for(var i in tags) {
                parsedTags += '· <a href="'+ document.location.origin + '/tags/#' + tags[i]+'" target="_blank">'+tags[i]+'</a> ';
            }
            parsedTags = parsedTags.substr(1);
            eventTextTags = '<p><i class="fa fa-tags"></i> ' + parsedTags + '</p>';
        }
        event.text.text = eventTextTags + eventText + eventTextSource;
        return event;
}
function GetFrameType(footer) {
        var frametype = "other";
        if (footer) {
            if ( footer.indexOf("bandcamp") > -1 ) {
                frametype = "bandcamp";
            } else if (footer.indexOf("soundcloud") > -1) {
                frametype = "soundcloud";
            }
        }
        return frametype;
}
function xml2jsobj(node) {
	var	data = {};
	// append a value
	function Add(name, value) {
		if (data[name]) {
			if (data[name].constructor != Array) {
				data[name] = [data[name]];
			}
			data[name][data[name].length] = value;
		}
		else {
			data[name] = value;
		}
	};
	// element attributes
	var c, cn;
	for (c = 0; cn = node.attributes[c]; c++) {
		Add(cn.name, cn.value);
	}
	// child elements
	for (c = 0; cn = node.childNodes[c]; c++) {
		if (cn.nodeType == 1) {
			if (cn.childNodes.length == 1 && cn.firstChild.nodeType == 3) {
				// text value
				if (cn.nodeName) {
					Add(cn.nodeName, cn.firstChild.nodeValue);
				}
			} else {
				// sub-object
				if (cn.nodeName) {
					// added to support cases when node is empty
					if (cn.childNodes.lenght > 0) {
						Add(cn.nodeName, xml2jsobj(cn));
					} else {
						Add(cn.nodeName, null);
					}
				}
			}
		}
	}
	return data;
}	
</script>
</body>
</html>
